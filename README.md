# help
https://rutube.ru/video/8299ac44bbcf3c82423e1467ae3ae390/
https://rutube.ru/video/6e57c188168afe8b782b698a600088d0/
https://rutube.ru/video/9d4a90f3893d5f056a62fb59d43efe9c/


![image](https://github.com/user-attachments/assets/be50fab5-ac09-4468-b450-0ed000ad04a8)
![image](https://github.com/user-attachments/assets/1031cf6b-f94b-4b12-9776-8f5128a02aa3)
![image](https://github.com/user-attachments/assets/db876e43-2d2d-4147-a7be-2c0dde824171)

```
Процедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, ВыборДобавлением, СтандартнаяОбработка) 

	Попытка
	Оповещение = Новый ОписаниеОповещения ("ЗагрузкаДанныхИзФайла", ЭтотОбъект);
	НачатьПомещениеФайлаНаСервер(Оповещение,,,,,УникальныйИдентификатор); 
	Исключение
	Предупреждение("Нет доступа к файлу. Проверьте, не открыт ли он в другом приложении.");
	КонецПопытки;

КонецПроцедуры 

&НаКлиенте
Процедура ЗагрузкаДанныхИзФайла (ОписаниеПомещенногоФайла, ДополнительныеПараметры) Экспорт
    Если ОписаниеПомещенногоФайла <> Неопределено Тогда
        ПутьКФайлу = ОписаниеПомещенногоФайла.СсылкаНаФайл.Файл.ПолноеИмя;
    КонецЕсли;
КонецПроцедуры

&НаСервере
Процедура ЗагрузкаПартнеровНаСервере(ТабДок, ПутьКФайлу)

    ТабДок.Прочитать(ПутьКФайлу, СпособЧтенияЗначенийТабличногоДокумента.Значение);
    ПостроительЗапроса = Новый ПостроительЗапроса;
    ПостроительЗапроса.ИсточникДанных = Новый ОписаниеИсточникаДанных(ТабДок.Область("Partners_import"));
    ПостроительЗапроса.Выполнить();

    ТаблицаПартнеров = ПостроительЗапроса.Результат.Выгрузить();

    Для каждого СтрокаТаблицы Из ТаблицаПартнеров Цикл

        НовыйПартнер = Справочники.Партнеры.СоздатьЭлемент();

        Если СтрокаТаблицы[0] = "ЗАО" Тогда
            ТипПартнераИзСтроки = Перечисления.ТипыПартнеров.ЗАО;
        ИначеЕсли СтрокаТаблицы[0] = "ООО" Тогда
            ТипПартнераИзСтроки = Перечисления.ТипыПартнеров.ООО;
        ИначеЕсли СтрокаТаблицы[0] = "ПАО" Тогда
            ТипПартнераИзСтроки = Перечисления.ТипыПартнеров.ПАО;
        ИначеЕсли СтрокаТаблицы[0] = "ОАО" Тогда
            ТипПартнераИзСтроки = Перечисления.ТипыПартнеров.ОАО;
        Иначе
            Сообщить("Новый неизвестный тип партнера: " + СтрокаТаблицы[0]);
        КонецЕсли;

        НовыйПартнер.ТипПартнера = ТипПартнераИзСтроки;
        НовыйПартнер.Наименование = СтрокаТаблицы[1];
    КонецЦикла;

КонецПроцедуры

1c

КонецПроцедуры

&НаКлиенте
Процедура ЗагрузкаПартнеров(Команда)

    ТабДок = Новый ТабличныйДокумент;
    ЗагрузкаПартнеровНаСервере(ТабДок, ПутьКФайлу);

КонецПроцедуры
```

![image](https://github.com/user-attachments/assets/ef77068a-1ecf-4765-8735-abb9b90e487c)

